{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/georgiosloulakis/Documents/instappfood_Project/components/main/Profile.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport TouchableHighlight from \"react-native-web/dist/exports/TouchableHighlight\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport firebase from 'firebase';\n\nrequire('firebase/firestore');\n\nimport { connect } from 'react-redux';\n\nfunction Profile(props) {\n  var _this = this;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      userPosts = _useState2[0],\n      setUserPosts = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      user = _useState4[0],\n      setUser = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      following = _useState6[0],\n      setFollowing = _useState6[1];\n\n  useEffect(function () {\n    var currentUser = props.currentUser,\n        posts = props.posts;\n\n    if (props.route.params.uid === firebase.auth().currentUser.uid) {\n      setUser(currentUser);\n      setUserPosts(posts);\n    } else {\n      firebase.firestore().collection(\"users\").doc(props.route.params.uid).get().then(function (snapshot) {\n        if (snapshot.exists) {\n          setUser(snapshot.data());\n        } else {\n          console.log('does not exist');\n        }\n      });\n      firebase.firestore().collection(\"posts\").doc(props.route.params.uid).collection(\"userPosts\").orderBy(\"creation\", \"asc\").get().then(function (snapshot) {\n        var posts = snapshot.docs.map(function (doc) {\n          var data = doc.data();\n          var id = doc.id;\n          return _objectSpread({\n            id: id\n          }, data);\n        });\n        setUserPosts(posts);\n      });\n    }\n\n    if (props.following.indexOf(props.route.params.uid) > -1) {\n      setFollowing(true);\n    } else {\n      setFollowing(false);\n    }\n  }, [props.route.params.uid, props.following]);\n\n  var onFollow = function onFollow() {\n    return _regeneratorRuntime.async(function onFollow$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            firebase.firestore().collection(\"following\").doc(firebase.auth().currentUser.uid).collection(\"userFollowing\").doc(props.route.params.uid).set({});\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var onUnfollow = function onUnfollow() {\n    return _regeneratorRuntime.async(function onUnfollow$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            firebase.firestore().collection(\"following\").doc(firebase.auth().currentUser.uid).collection(\"userFollowing\").doc(props.route.params.uid).delete();\n\n          case 1:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var onLogout = function onLogout() {\n    return _regeneratorRuntime.async(function onLogout$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return _regeneratorRuntime.awrap(firebase.auth().signOut());\n\n          case 2:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  if (user === null) {\n    return React.createElement(View, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 16\n      }\n    });\n  }\n\n  var updateItem = function updateItem(id) {\n    setUserPosts(function _callee(prevState) {\n      var removed;\n      return _regeneratorRuntime.async(function _callee$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              removed = prevState.splice(1);\n              return _context4.abrupt(\"return\", _toConsumableArray(prevState));\n\n            case 3:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    });\n  };\n\n  var deleteItem = function deleteItem(id) {\n    return Alert.alert(\"Are your sure?\", \"Are you sure you want to remove this Post?\", [{\n      text: \"Yes\",\n      onPress: function onPress() {\n        setUserPosts(function _callee2(prevState) {\n          var removed;\n          return _regeneratorRuntime.async(function _callee2$(_context5) {\n            while (1) {\n              switch (_context5.prev = _context5.next) {\n                case 0:\n                  _context5.next = 2;\n                  return _regeneratorRuntime.awrap(firebase.firestore().collection('posts').doc(firebase.auth().currentUser.uid).collection('userPosts').doc(id).delete());\n\n                case 2:\n                  removed = prevState.splice(id, 1);\n                  return _context5.abrupt(\"return\", _toConsumableArray(prevState));\n\n                case 5:\n                case \"end\":\n                  return _context5.stop();\n              }\n            }\n          }, null, null, null, Promise);\n        });\n      }\n    }, {\n      text: \"No\"\n    }]);\n  };\n\n  return React.createElement(SafeAreaView, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: styles.rowContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }\n  }, React.createElement(View, {\n    style: styles.containerInfo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 29\n    }\n  }, React.createElement(Text, {\n    style: styles.containerInfo2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 33\n    }\n  }, user.name), React.createElement(Text, {\n    style: styles.containerInfo2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 33\n    }\n  }, user.email)), React.createElement(View, {\n    style: {\n      justifyContent: 'flex-end',\n      width: '20%',\n      justifyContent: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 17\n    }\n  }, props.route.params.uid !== firebase.auth().currentUser.uid ? React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 29\n    }\n  }, following ? React.createElement(Text, {\n    style: {\n      color: 'red',\n      fontWeight: '800'\n    },\n    onPress: function onPress() {\n      return onUnfollow();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 37\n    }\n  }, \" Follow \") : React.createElement(Text, {\n    style: {\n      color: 'green',\n      fontWeight: '800'\n    },\n    onPress: function onPress() {\n      return onFollow();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 37\n    }\n  }, \" Following \")) : React.createElement(Text, {\n    style: {\n      color: 'red',\n      fontWeight: '800'\n    },\n    onPress: function onPress() {\n      return onLogout();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 33\n    }\n  }, \" Logout \"))), React.createElement(View, {\n    style: styles.Containerbio,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: styles.bio,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 21\n    }\n  }, user.bio)), React.createElement(View, {\n    style: styles.containerGallery,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 13\n    }\n  }, React.createElement(FlatList, {\n    numColumns: 3,\n    horizontal: false,\n    data: userPosts,\n    extraData: userPosts,\n    onPress: function onPress() {\n      return deleteItem(item.id);\n    },\n    renderItem: function renderItem(_ref) {\n      var item = _ref.item;\n      return React.createElement(View, {\n        style: styles.containerImage,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 25\n        }\n      }, props.route.params.uid !== firebase.auth().currentUser.uid ? React.createElement(TouchableHighlight, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 46\n        }\n      }, React.createElement(Image, {\n        style: styles.image,\n        source: {\n          uri: item.downloadURL\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 46\n        }\n      })) : React.createElement(TouchableHighlight, {\n        onPress: function onPress() {\n          return deleteItem(item.id);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 37\n        }\n      }, React.createElement(Image, {\n        style: styles.image,\n        source: {\n          uri: item.downloadURL\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 37\n        }\n      })));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 17\n    }\n  })));\n}\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  rowContainer: {\n    flexDirection: 'row',\n    padding: '2%'\n  },\n  containerInfo: {\n    margin: 20,\n    width: '55%'\n  },\n  containerInfo2: {\n    color: 'gray',\n    fontWeight: '700'\n  },\n  containerGallery: {\n    flex: 1,\n    borderRadius: 12,\n    margin: 1\n  },\n  containerImage: {\n    flex: 1 / 3,\n    padding: 0,\n    margin: 2,\n    borderRadius: 6,\n    backgroundColor: '#DDC9BC'\n  },\n  image: {\n    flex: 1,\n    aspectRatio: 1 / 1,\n    borderRadius: 9\n  },\n  bio: {\n    padding: '2%',\n    color: 'gray',\n    fontSize: 15,\n    fontWeight: 'normal'\n  },\n  Containerbio: {\n    borderRadius: 10,\n    padding: 5,\n    margin: 4\n  }\n});\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    currentUser: store.userState.currentUser,\n    posts: store.userState.posts,\n    following: store.userState.following\n  };\n};\n\nexport default connect(mapStateToProps, null)(Profile);","map":{"version":3,"sources":["/Users/georgiosloulakis/Documents/instappfood_Project/components/main/Profile.js"],"names":["React","useState","useEffect","SafeAreaView","firebase","require","connect","Profile","props","userPosts","setUserPosts","user","setUser","following","setFollowing","currentUser","posts","route","params","uid","auth","firestore","collection","doc","get","then","snapshot","exists","data","console","log","orderBy","docs","map","id","indexOf","onFollow","set","onUnfollow","delete","onLogout","signOut","updateItem","prevState","removed","splice","deleteItem","Alert","alert","text","onPress","styles","container","rowContainer","containerInfo","containerInfo2","name","email","justifyContent","width","color","fontWeight","Containerbio","bio","containerGallery","item","containerImage","image","uri","downloadURL","StyleSheet","create","flex","flexDirection","padding","margin","borderRadius","backgroundColor","aspectRatio","fontSize","mapStateToProps","store","userState"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { StyleSheet, View, Text, Image, FlatList, TouchableHighlight, Alert } from 'react-native'\nimport { SafeAreaView } from 'react-native-safe-area-context'\nimport firebase from 'firebase'\nrequire('firebase/firestore')\nimport { connect } from 'react-redux'\n\nfunction Profile(props) {\n    const [userPosts, setUserPosts] = useState([]);\n    const [user, setUser] = useState(null);\n    const [following, setFollowing] = useState(false)\n\n    useEffect(() => {\n        const { currentUser, posts } = props;\n\n        if (props.route.params.uid === firebase.auth().currentUser.uid) {\n            setUser(currentUser)\n            setUserPosts(posts)\n        }\n        else {\n            firebase.firestore()\n                .collection(\"users\")\n                .doc(props.route.params.uid)\n                .get()\n                .then((snapshot) => {\n                    if (snapshot.exists) {\n                        setUser(snapshot.data());\n                    }\n                    else {\n                        console.log('does not exist')\n                    }\n                })\n            firebase.firestore()\n                .collection(\"posts\")\n                .doc(props.route.params.uid)\n                .collection(\"userPosts\")\n                .orderBy(\"creation\", \"asc\")\n                .get()\n                .then((snapshot) => {\n                    let posts = snapshot.docs.map(doc => {\n                        const data = doc.data();\n                        const id = doc.id;\n                        return { id, ...data }\n                    })\n                    setUserPosts(posts)\n                })\n        }\n\n        if (props.following.indexOf(props.route.params.uid) > -1) {\n            setFollowing(true);\n        } else {\n            setFollowing(false);\n        }\n\n    }, [props.route.params.uid, props.following])\n\n  \n\n    const onFollow = async () => {\n         firebase.firestore()\n            .collection(\"following\")\n            .doc(firebase.auth().currentUser.uid)\n            .collection(\"userFollowing\")\n            .doc(props.route.params.uid)\n            .set({})\n    }\n    const onUnfollow = async () => {\n         firebase.firestore()\n            .collection(\"following\")\n            .doc(firebase.auth().currentUser.uid)\n            .collection(\"userFollowing\")\n            .doc(props.route.params.uid)\n            .delete()\n    }\n\n    const onLogout = async () => {\n        await firebase.auth().signOut();\n    }\n\n    if (user === null) {\n        return <View />\n    }\n\n    const updateItem = (id) =>{\n         setUserPosts(async(prevState)=>{\n                    const removed = prevState.splice(1)\n                    return[...prevState]\n                    console.log(id)})\n    }\n\n    const deleteItem = (id) => {\n        return Alert.alert(\n            \"Are your sure?\",\n            \"Are you sure you want to remove this Post?\",\n            [\n              {\n                text: \"Yes\",\n                onPress:  () => {\n                 setUserPosts(async(prevState)=>{\n                    await firebase.firestore()\n                    .collection('posts')\n                    .doc(firebase.auth().currentUser.uid)\n                    .collection('userPosts')\n                    .doc(id)\n                    .delete()\n                    const removed = prevState.splice(id,1)\n                    return[...prevState]\n                    console.log(removed)\n                 }\n                 )},\n              },\n              {\n                text: \"No\",\n              },\n            ]\n          );\n       \n    }\n\n    return (\n        \n        <SafeAreaView style={styles.container}>\n            <View style={styles.rowContainer}>\n\n                            <View style={styles.containerInfo}>\n                                <Text style={styles.containerInfo2}>{user.name}</Text>\n                                <Text style={styles.containerInfo2}>{user.email}</Text>\n                            </View>\n\n                <View style={{justifyContent: 'flex-end',width:'20%',justifyContent:'center'}}>\n                        {props.route.params.uid !== firebase.auth().currentUser.uid ? (\n                            <View>\n                                {following ? (\n                                    <Text style={{color:'red', fontWeight:'800'}} onPress={() => onUnfollow()}> Follow </Text>\n                                ) :\n                                (\n                                    <Text style={{color:'green',fontWeight:'800'}} onPress={() => onFollow()}> Following </Text>\n                                )}\n                            </View>\n                        ) :\n                                <Text style={{color:'red',fontWeight:'800'}} onPress={() => onLogout()} > Logout </Text>\n                        }\n                </View>\n               \n            </View>\n            <View  style={styles.Containerbio}>\n                    <Text style={styles.bio}>{user.bio}</Text>     \n            </View>\n\n            <View style={styles.containerGallery}>\n                <FlatList\n                    numColumns={3}\n                    horizontal={false}\n                    data={userPosts}\n                    extraData={userPosts}\n                    onPress={() => deleteItem(item.id)}\n                    renderItem={({ item }) => (\n                        <View\n                            style={styles.containerImage}>\n                                 {props.route.params.uid !== firebase.auth().currentUser.uid ? (\n                                             <TouchableHighlight>\n                                             <Image\n                                                     style={styles.image}\n                                                     source={{ uri: item.downloadURL }}\n                                                 />\n                                            </TouchableHighlight>\n                                 ):\n                                 (\n                                    <TouchableHighlight \n                                    onPress={() => deleteItem(item.id)}>\n                                    <Image\n                                            style={styles.image}\n                                            source={{ uri: item.downloadURL }}\n                                        />\n                                </TouchableHighlight>\n                                 )}\n                         \n                        </View>\n                   \n                    )}\n                    \n                />\n                         \n            </View>\n        </SafeAreaView>\n\n    )\n}\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n    },\n    rowContainer: {\n        flexDirection: 'row',\n        padding: '2%'\n    },\n    containerInfo: {\n        margin: 20,\n        width:'55%',\n        \n    },\n    containerInfo2: {\n        color:'gray',\n        fontWeight:'700'\n        \n    },\n    containerGallery: {\n        flex: 1,\n        borderRadius:12,\n        margin:1\n    },\n    containerImage: {\n        flex: 1 / 3,\n        padding:0,\n        margin:2,\n        borderRadius:6,\n        backgroundColor:'#DDC9BC'\n\n    },\n    image: {\n        flex: 1,\n        aspectRatio: 1 / 1,\n        borderRadius:9,\n    },\n    bio:{\n        padding: '2%',\n        color:'gray',\n        fontSize:15,\n        fontWeight:'normal'\n    },\n    Containerbio:{\n        borderRadius:10,\n        padding:5,\n        margin:4\n    }\n})\nconst mapStateToProps = (store) => ({\n    currentUser: store.userState.currentUser,\n    posts: store.userState.posts,\n    following: store.userState.following\n})\nexport default connect(mapStateToProps, null)(Profile);"]},"metadata":{},"sourceType":"module"}